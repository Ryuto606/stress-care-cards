<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ストレスケアカード - インタラクティブ版</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Yu Gothic', 'Meiryo', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }
    
    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }
    
    .subtitle {
      font-size: 1.1em;
      opacity: 0.9;
    }
    
    /* 注意事項 */
    .notice {
      background: rgba(255, 255, 255, 0.95);
      border-left: 4px solid #f59e0b;
      padding: 15px 20px;
      margin-bottom: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .notice-header {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: bold;
      font-size: 0.95em;
      color: #78350f;
      margin-bottom: 10px;
    }
    
    .notice-icon {
      font-size: 1.2em;
    }
    
    .notice-content {
      font-size: 0.85em;
      line-height: 1.6;
      color: #666;
    }
    
    .notice-content ul {
      list-style: none;
      padding: 0;
      margin: 8px 0 0 0;
    }
    
    .notice-content li {
      padding: 4px 0;
      padding-left: 16px;
      position: relative;
    }
    
    .notice-content li:before {
      content: '•';
      position: absolute;
      left: 0;
      color: #f59e0b;
      font-weight: bold;
    }
    
    /* フィルター */
    .filters {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .filter-group {
      margin-bottom: 15px;
    }
    
    .filter-group label {
      font-weight: bold;
      display: block;
      margin-bottom: 8px;
      color: #333;
    }
    
    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .filter-btn {
      padding: 8px 16px;
      border: 2px solid #e0e0e0;
      background: white;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.9em;
    }
    
    .filter-btn:hover {
      border-color: #667eea;
      background: #f0f0ff;
    }
    
    .filter-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    .search-box {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      transition: border-color 0.3s;
    }
    
    .search-box:focus {
      outline: none;
      border-color: #667eea;
    }
    
    /* カードグリッド */
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .card-item {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
      display: flex;
      flex-direction: column;
    }
    
    .card-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 12px rgba(0,0,0,0.2);
    }
    
    .card-header {
      padding: 15px;
      min-height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      flex: 1;
    }
    
    .card-category {
      font-size: 0.8em;
      font-weight: bold;
      color: #666;
      margin-bottom: 10px;
    }
    
    .card-title {
      font-size: 1.3em;
      font-weight: bold;
      text-align: center;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1.3;
    }
    
    .card-targets {
      font-size: 0.75em;
      color: #999;
      margin-top: 10px;
    }
    
    /* カテゴリ別カラー */
    .cat-work { background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%); }
    .cat-commute { background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%); }
    .cat-relations { background: linear-gradient(135deg, #E9D5FF 0%, #D8B4FE 100%); }
    .cat-home { background: linear-gradient(135deg, #FED7AA 0%, #FDBA74 100%); }
    .cat-job { background: linear-gradient(135deg, #FBCFE8 0%, #F9A8D4 100%); }
    
    /* モーダル */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 1000;
      overflow-y: auto;
      padding: 20px;
    }
    
    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      background: white;
      border-radius: 15px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      animation: slideIn 0.3s;
    }
    
    @keyframes slideIn {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .modal-header {
      padding: 25px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .modal-category {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 10px;
    }
    
    .modal-title {
      font-size: 2em;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .modal-targets {
      font-size: 0.9em;
      color: #999;
    }
    
    .modal-body {
      padding: 25px;
    }
    
    .method-section {
      margin-bottom: 20px;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid;
    }
    
    .method-section:last-child {
      margin-bottom: 0;
    }
    
    .difficulty-1 {
      background: #D1FAE5;
      border-color: #10B981;
    }
    
    .difficulty-2 {
      background: #A7F3D0;
      border-color: #059669;
    }
    
    .difficulty-3 {
      background: #6EE7B7;
      border-color: #047857;
    }
    
    .method-header {
      font-weight: bold;
      font-size: 0.95em;
      margin-bottom: 8px;
      color: #000;
    }
    
    .star {
      color: #F59E0B;
    }
    
    .method-title {
      font-weight: bold;
      font-size: 1em;
      margin-bottom: 8px;
      line-height: 1.4;
    }
    
    .method-tips {
      font-size: 0.9em;
      color: #1e40af;
      margin-top: 5px;
      line-height: 1.4;
    }
    
    .method-evidence {
      font-size: 0.85em;
      color: #059669;
      margin-top: 5px;
    }
    
    .therapy-link {
      color: #059669;
      text-decoration: underline;
      cursor: help;
      position: relative;
      font-weight: bold;
    }
    
    .therapy-link:hover {
      color: #047857;
    }
    
    /* ツールチップ */
    .tooltip {
      position: fixed;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 0.9em;
      max-width: 300px;
      z-index: 10000;
      pointer-events: none;
      line-height: 1.5;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    
    .tooltip:before {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 20px;
      width: 12px;
      height: 12px;
      background: rgba(0, 0, 0, 0.9);
      transform: rotate(45deg);
    }
    
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 40px;
      height: 40px;
      border: none;
      background: #f0f0f0;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5em;
      color: #666;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .close-btn:hover {
      background: #e0e0e0;
      color: #333;
    }
    
    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: white;
      font-size: 1.2em;
    }
    
    /* レスポンシブ */
    @media (max-width: 768px) {
      h1 {
        font-size: 1.8em;
      }
      
      .notice {
        padding: 12px 15px;
        font-size: 0.9em;
      }
      
      .notice-header {
        font-size: 0.9em;
      }
      
      .notice-content {
        font-size: 0.8em;
      }
      
      .cards-grid {
        grid-template-columns: 1fr;
      }
      
      .modal-content {
        margin: 20px;
      }
      
      .modal-title {
        font-size: 1.5em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>🌿 ストレスケアカード</h1>
      <p class="subtitle">あなたのストレスに合った対処法を見つけましょう</p>
    </header>
    
    <div class="notice">
      <div class="notice-header">
        <span class="notice-icon">⚠️</span>
        <span>このカードの使い方と注意事項</span>
      </div>
      <div class="notice-content">
        <ul>
          <li>これらの対処法は科学的根拠に基づいていますが、すべての人に効果があるとは限りません</li>
          <li><span class="star">★★★</span>の対処法は専門家のサポートが必要です</li>
          <li>症状が重い場合や改善しない場合は、必ず医療機関を受診してください</li>
          <li>自己判断での薬の中止や変更は危険です。必ず医師に相談してください</li>
          <li>緊急時（自傷や自殺念慮など）は、すぐに専門機関（#いのちSOS 0120-061-338など）に連絡してください</li>
        </ul>
      </div>
    </div>
    
    <div class="filters">
      <div class="filter-group">
        <label>カテゴリで絞り込み</label>
        <div class="filter-buttons">
          <button class="filter-btn active" data-category="all">すべて</button>
          <button class="filter-btn" data-category="work">職場・作業中</button>
          <button class="filter-btn" data-category="commute">通勤・移動中</button>
          <button class="filter-btn" data-category="relations">人間関係</button>
          <button class="filter-btn" data-category="home">家庭・日常</button>
          <button class="filter-btn" data-category="job">就職活動</button>
        </div>
      </div>
      
      <div class="filter-group">
        <label>キーワードで検索</label>
        <input type="text" class="search-box" id="searchBox" placeholder="例: 集中、不安、疲れた...">
      </div>
    </div>
    
    <div class="cards-grid" id="cardsGrid"></div>
    
    <div class="no-results" id="noResults" style="display: none;">
      該当するカードが見つかりませんでした
    </div>
  </div>
  
  <div class="modal" id="modal">
    <div class="modal-content">
      <button class="close-btn" onclick="closeModal()">×</button>
      <div class="modal-header" id="modalHeader"></div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>
  
  <script>
    // 療法の解説データ
    const therapyInfo = {
      '行動療法': '問題行動を減らし、適応的な行動を増やすことを目指す心理療法。具体的な行動の変化に焦点を当てます。',
      '認知行動療法': '考え方（認知）と行動の両方を変えることで、気持ちや問題を改善する心理療法。科学的根拠が豊富です。',
      'SST': 'ソーシャルスキルトレーニング。対人関係や社会生活に必要なスキルを練習を通して身につける訓練法です。',
      'リラクセーション法': '心身の緊張を和らげるための技法。呼吸法、筋弛緩法、瞑想などが含まれます。',
      '暴露療法': '恐怖や不安を引き起こす状況に段階的に直面することで、不安を軽減する治療法です。',
      'スキーマ療法': '幼少期から形成された思考パターン（スキーマ）を特定し、修正する心理療法です。',
      '行動活性化療法': 'うつ病治療の一つ。活動量を増やし、楽しみや達成感を取り戻すことを目指します。',
      'アサーション': '自分の気持ちや意見を、相手を尊重しながら適切に表現するコミュニケーション技法です。',
      'ACT': 'アクセプタンス＆コミットメント・セラピー。思考や感情を受け入れ、価値に基づいた行動をとることを目指します。',
      'アンガーマネジメント': '怒りの感情を適切にコントロールし、建設的に対処する方法を学ぶプログラムです。',
      'DBT': '弁証法的行動療法。感情調節、対人関係、ストレス耐性などのスキルを総合的に訓練します。',
      '環境調整法': '物理的・社会的環境を整えることで、ストレスを軽減し、適応を促進する方法です。',
      '作業療法': '日常生活活動を通して、心身の機能回復や生活の質の向上を図るリハビリテーションです。',
      'ソーシャルストーリー': '社会的状況を視覚的・具体的に説明する手法。特にASDの方に有効です。',
      '問題解決療法': '問題を構造的に分析し、具体的な解決策を見つけて実行する技法です。',
      '認知リハビリテーション': '記憶、注意、実行機能などの認知機能を改善するための訓練プログラムです。',
      'メタ認知療法': '自分の思考プロセスを客観的に観察し、コントロールする能力を高める療法です。',
      '職業リハビリテーション': '就労に向けた準備や、職場での適応を支援する総合的なプログラムです。',
      'セルフケア': '自分自身の心身の健康を維持・向上させるための主体的な取り組みです。',
      'セルフモニタリング': '自分の行動、思考、感情を記録・観察することで、パターンや問題に気づく技法です。',
      '医学的評価': '医師による診察・検査を通じて、症状の原因を特定し、適切な治療方針を決定します。',
      '暴露反応妨害法': '強迫性障害の治療法。不安場面に直面しながら、強迫行為を我慢する練習をします。',
      '現実検討': '自分の考えや認識が現実と合っているか確認する技法です。',
      'MBCT': 'マインドフルネス認知療法。瞑想と認知療法を組み合わせた、再発予防に効果的な治療法です。',
      'マインドフルネス': '今この瞬間に、評価せずに注意を向ける練習。ストレス軽減に効果があります。',
      '薬物療法': '薬を用いて症状を軽減する治療法。医師の処方と管理のもとで行います。',
      '心理療法': '対話を通じて心理的問題の解決を図る治療の総称です。',
      '睡眠衛生': '良質な睡眠を得るための生活習慣や環境づくりの方法です。',
      '認知行動療法(不眠)': '不眠症に特化した認知行動療法。睡眠に関する誤った考えを修正します。',
      'CBT-I': '不眠症の認知行動療法の英語略称。科学的に効果が実証されています。',
      '社会リハビリテーション': '社会参加や対人関係を通じて、生活の質を向上させる支援プログラムです。',
      '医学的治療': '医師による診断・治療。薬物療法や専門的医療処置を含みます。',
      '依存症治療': '依存症に特化した専門的治療プログラム。心理療法と医学的アプローチを組み合わせます。',
      'EMDR': '眼球運動による脱感作と再処理法。トラウマ記憶の処理に効果的な治療法です。',
      '医学的治療': '医学的な診断と治療。症状に応じた適切な医療介入を行います。',
      '準備技法': '本番に向けて事前に準備する方法。不安を軽減し、パフォーマンスを向上させます。',
      '認知再構成': '否定的・非合理的な考え方を、より現実的でバランスの取れた考え方に変える技法です。',
      '意思決定支援': '重要な決定をする際に、選択肢を整理し、最適な判断を導く支援方法です。',
      '就労支援': '就職活動や職場定着を総合的にサポートするプログラムです。',
      '医療・福祉サービス': '医療機関や福祉制度による専門的な支援サービスです。'
    };
    
    const cardsData = [
      // 職場・作業中 (1-20)
      {
        id: 1,
        category: 'work',
        categoryName: '職場・作業中',
        title: '集中が続かない',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: 'ポモドーロ法: 25分作業+5分休憩', tips: 'タイマーセット、休憩時は席を立つ', evidence: '行動療法' },
          { difficulty: 2, title: 'セルフモニタリング: 集中時間記録', tips: '集中できた時を記録し良い条件を再現', evidence: '認知行動療法' },
          { difficulty: 3, title: 'SST: 環境調整の交渉方法を練習', tips: 'ロールプレイで配慮依頼を練習', evidence: 'SST' }
        ]
      },
      {
        id: 2,
        category: 'work',
        categoryName: '職場・作業中',
        title: '予定が急に変わった',
        targets: 'ASD / 不安障害',
        methods: [
          { difficulty: 1, title: '4-7-8呼吸法(4秒吸7秒止8秒吐)', tips: '呼吸に集中し自律神経を整える', evidence: 'リラクセーション法' },
          { difficulty: 2, title: '認知再構成:「変更=悪」→「対応機会」', tips: '自動思考→根拠→反証→バランス思考', evidence: '認知行動療法' },
          { difficulty: 3, title: '段階的暴露療法: 小さな変更から慣れる', tips: '不安階層表作成し段階的に経験', evidence: '暴露療法' }
        ]
      },
      {
        id: 3,
        category: 'work',
        categoryName: '職場・作業中',
        title: 'ミスをして落ち込む',
        targets: 'うつ病 / 全般',
        methods: [
          { difficulty: 1, title: '思考記録: 事実と感情を分けて書く', tips: '「ミスした(事実)」と「ダメ(感情)」を区別', evidence: '認知行動療法' },
          { difficulty: 2, title: '認知の歪みチェック: 過度の一般化に気づく', tips: '「いつも」「絶対」を「今回」に限定', evidence: '認知行動療法' },
          { difficulty: 3, title: 'スキーマ療法: 根底の信念を扱う', tips: '幼少期経験と現在の反応パターン理解', evidence: 'スキーマ療法' }
        ]
      },
      {
        id: 4,
        category: 'work',
        categoryName: '職場・作業中',
        title: '疲れたけど休憩しづらい',
        targets: '全般',
        methods: [
          { difficulty: 1, title: 'セルフケア: トイレ+水分補給', tips: '「休憩=怠け」は歪み。体のサインを尊重', evidence: '行動活性化療法' },
          { difficulty: 2, title: 'アサーション:「少し休憩します」と伝える', tips: '攻撃的でも受動的でもないアサーティブな主張', evidence: 'SST/アサーション' },
          { difficulty: 3, title: 'ACT: 価値に基づく行動選択', tips: '「他者評価」より「自分の健康」を優先', evidence: 'ACT' }
        ]
      },
      {
        id: 5,
        category: 'work',
        categoryName: '職場・作業中',
        title: 'イライラする',
        targets: '全般 / 双極性障害',
        methods: [
          { difficulty: 1, title: '漸進的筋弛緩法: 拳を握る→緩める', tips: '筋肉の緊張と弛緩を意識的に体験', evidence: 'リラクセーション法' },
          { difficulty: 2, title: 'アンガーマネジメント: レベル3以下で対処', tips: '怒りの前兆に気づいたらタイムアウト', evidence: 'アンガーマネジメント' },
          { difficulty: 3, title: 'DBT: 感情調節スキル訓練', tips: 'PLEASE、TIPP、対人効果性を学ぶ', evidence: 'DBT' }
        ]
      },
      {
        id: 6,
        category: 'work',
        categoryName: '職場・作業中',
        title: '感覚過敏がつらい',
        targets: 'ASD / 感覚過敏',
        methods: [
          { difficulty: 1, title: '環境調整: イヤーマフ、サングラス使用', tips: '感覚刺激を物理的に減らす。合理的配慮要請可', evidence: '環境調整法' },
          { difficulty: 2, title: 'センサリーダイエット: 感覚入力を管理', tips: '刺激多い活動の前後に休息。プロフィール理解', evidence: '作業療法' },
          { difficulty: 3, title: 'ソーシャルストーリー: 対処を視覚的に学習', tips: '具体的手順を絵や写真で示す', evidence: 'ソーシャルストーリー' }
        ]
      },
      {
        id: 7,
        category: 'work',
        categoryName: '職場・作業中',
        title: 'やるべきことが多すぎる',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: 'タスク外在化: 全部書き出し3つだけ選ぶ', tips: '脳内で抱えず紙に出す。緊急×重要で判断', evidence: '行動療法' },
          { difficulty: 2, title: '問題解決療法: 定義→選択肢→評価→実行', tips: '感情でなく構造的に問題を扱う', evidence: '問題解決療法' },
          { difficulty: 3, title: 'エグゼクティブ機能訓練: 計画・管理訓練', tips: '実行機能を強化する具体的戦略', evidence: '認知リハビリテーション' }
        ]
      },
      {
        id: 8,
        category: 'work',
        categoryName: '職場・作業中',
        title: '周りの目が気になる',
        targets: '不安障害 / 全般',
        methods: [
          { difficulty: 1, title: 'セルフトーク:「周りは私ほど見ていない」', tips: 'スポットライト効果の心理学的事実を思い出す', evidence: '認知行動療法' },
          { difficulty: 2, title: '注意訓練法: 外部対象に意図的に注意向ける', tips: '自己に向いた注意を外界に向け直す', evidence: 'メタ認知療法' },
          { difficulty: 3, title: 'MBCT: 思考と現実を区別するメタ認知', tips: '「不安思考がある」≠「見られている」', evidence: 'MBCT' }
        ]
      },
      {
        id: 9,
        category: 'work',
        categoryName: '職場・作業中',
        title: '作業手順を忘れた',
        targets: '全般 / 知的障害',
        methods: [
          { difficulty: 1, title: '外的補助具: チェックリスト、マニュアル常備', tips: '記憶に頼らず、視覚的手がかり使用', evidence: '認知リハビリテーション' },
          { difficulty: 2, title: '記憶方略: 視覚化、語呂合わせ、チャンキング', tips: '頭文字で覚える、イメージと結びつける', evidence: '認知リハビリテーション' },
          { difficulty: 3, title: 'エラーレスラーニング: 間違えずに学習', tips: '正しい手順のみを繰り返し練習', evidence: '認知リハビリテーション' }
        ]
      },
      {
        id: 10,
        category: 'work',
        categoryName: '職場・作業中',
        title: '指示を聞き逃した',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: '「すみません、もう一度お願いします」', tips: 'メモを取りながら聞く習慣をつける', evidence: 'アサーション' },
          { difficulty: 2, title: '5W1H確認法: 具体的に確認', tips: '曖昧な指示を具体化する質問テクニック', evidence: 'SST' },
          { difficulty: 3, title: 'SST: 質問の仕方をロールプレイ練習', tips: '「〇〇ということですか?」と復唱確認', evidence: 'SST' }
        ]
      },
      {
        id: 11,
        category: 'work',
        categoryName: '職場・作業中',
        title: '急なトラブルで混乱',
        targets: 'ASD / 全般',
        methods: [
          { difficulty: 1, title: '一時停止: トイレや飲み物で5分時間を作る', tips: '落ち着いてから対応開始', evidence: '行動療法' },
          { difficulty: 2, title: '問題の要素分解: 「何が」「いつまでに」整理', tips: '大きな問題を小さく分ける', evidence: '問題解決療法' },
          { difficulty: 3, title: 'トラブル対応マニュアルを事前に作成', tips: '支援者と想定される問題をリスト化', evidence: '認知リハビリテーション' }
        ]
      },
      {
        id: 12,
        category: 'work',
        categoryName: '職場・作業中',
        title: '同じ作業の繰り返しに飽きた',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: '小さな変化をつける: 音楽、順番、場所', tips: '作業そのものは変えず環境を変える', evidence: '行動療法' },
          { difficulty: 2, title: '意味づけ: 「なぜこの作業が大切か」考える', tips: '目的意識を持つと継続しやすい', evidence: '認知行動療法' },
          { difficulty: 3, title: '業務内容の見直しを相談', tips: '適性に合った業務配置の調整', evidence: '職業リハビリテーション' }
        ]
      },
      {
        id: 13,
        category: 'work',
        categoryName: '職場・作業中',
        title: '声が聞こえる・気になる',
        targets: '統合失調症 / 全般',
        methods: [
          { difficulty: 1, title: 'イヤホンで音楽を聴く(許可があれば)', tips: '声を物理的に遮断する', evidence: '環境調整法' },
          { difficulty: 2, title: '現実検討: 「今、本当に聞こえているか」確認', tips: '周りの人に聞こえるか聞いてみる', evidence: '認知行動療法' },
          { difficulty: 3, title: '医療機関で相談・服薬調整', tips: '幻聴の頻度・内容を記録して医師に報告', evidence: '薬物療法' }
        ]
      },
      {
        id: 14,
        category: 'work',
        categoryName: '職場・作業中',
        title: '完璧にできない自分が許せない',
        targets: '強迫性障害 / 全般',
        methods: [
          { difficulty: 1, title: '「70点でOK」ルールを作る', tips: '完璧でなくても十分と自分に許可する', evidence: '認知行動療法' },
          { difficulty: 2, title: '不完全暴露: わざとミスを残す練習', tips: '「完璧でなくても大丈夫」を体験で学ぶ', evidence: '暴露反応妨害法' },
          { difficulty: 3, title: '強迫性障害の専門治療(ERP)', tips: '認知行動療法の専門家と段階的に取り組む', evidence: '暴露反応妨害法' }
        ]
      },
      {
        id: 15,
        category: 'work',
        categoryName: '職場・作業中',
        title: '質問したいけど話しかけられない',
        targets: '不安障害 / 全般',
        methods: [
          { difficulty: 1, title: 'メール・メモで質問を送る', tips: '文字なら落ち着いて伝えられる', evidence: '環境調整法' },
          { difficulty: 2, title: '質問の台本を作る', tips: '「〇〇について教えてください」を準備', evidence: 'SST' },
          { difficulty: 3, title: '社交不安障害の認知行動療法', tips: '段階的な対人スキル訓練', evidence: '認知行動療法' }
        ]
      },
      {
        id: 16,
        category: 'work',
        categoryName: '職場・作業中',
        title: '急に不安になった',
        targets: 'パニック障害 / 不安障害',
        methods: [
          { difficulty: 1, title: '4-7-8呼吸法で自律神経を整える', tips: '4秒吸って7秒止めて8秒吐く', evidence: 'リラクセーション法' },
          { difficulty: 2, title: 'グラウンディング: 5感で「今ここ」に戻る', tips: '見える物5つ、聞こえる音4つ、触れる物3つ', evidence: 'マインドフルネス' },
          { difficulty: 3, title: 'パニック障害の認知行動療法', tips: 'パニック発作への対処と予期不安の軽減', evidence: '認知行動療法' }
        ]
      },
      {
        id: 17,
        category: 'work',
        categoryName: '職場・作業中',
        title: '体調が悪い',
        targets: '全般',
        methods: [
          { difficulty: 1, title: '上司・支援者に早めに伝える', tips: '我慢せず、休憩や早退を相談', evidence: 'セルフケア' },
          { difficulty: 2, title: '体調記録: パターンを見つける', tips: 'いつ悪化するか記録し予防策を立てる', evidence: 'セルフモニタリング' },
          { difficulty: 3, title: '医療機関で原因を特定', tips: '薬の副作用や持病の可能性も', evidence: '医学的評価' }
        ]
      },
      {
        id: 18,
        category: 'work',
        categoryName: '職場・作業中',
        title: '評価されないと感じる',
        targets: 'うつ病 / 全般',
        methods: [
          { difficulty: 1, title: '小さな成果を記録する', tips: 'できたことリストを作る', evidence: '認知行動療法' },
          { difficulty: 2, title: '評価基準を明確にする相談', tips: '何を期待されているか上司と確認', evidence: '問題解決療法' },
          { difficulty: 3, title: '自己価値の再構築(スキーマ療法)', tips: '他者評価に依存しない自己肯定感を育む', evidence: 'スキーマ療法' }
        ]
      },
      {
        id: 19,
        category: 'work',
        categoryName: '職場・作業中',
        title: '環境の変化についていけない',
        targets: 'ASD / 全般',
        methods: [
          { difficulty: 1, title: '変化の内容をリスト化する', tips: '何が変わったか整理すると対応しやすい', evidence: '認知行動療法' },
          { difficulty: 2, title: '移行支援: 段階的に慣れる計画', tips: '小さな変化から徐々に適応', evidence: '行動療法' },
          { difficulty: 3, title: '環境調整の交渉', tips: '支援者と一緒に配慮を依頼', evidence: '職業リハビリテーション' }
        ]
      },
      {
        id: 20,
        category: 'work',
        categoryName: '職場・作業中',
        title: '仕事のペースが合わない',
        targets: '全般',
        methods: [
          { difficulty: 1, title: 'ペース配分: 自分のリズムを守る', tips: '急がず、一定のペースを維持', evidence: '行動療法' },
          { difficulty: 2, title: '業務量の調整を相談', tips: '無理のない範囲で働けるよう交渉', evidence: '職業リハビリテーション' },
          { difficulty: 3, title: '就労形態の見直し(時短・在宅)', tips: '自分に合った働き方を模索', evidence: '職業リハビリテーション' }
        ]
      },
      
      // 通勤・移動中 (21-30)
      {
        id: 21,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '満員電車がつらい',
        targets: 'パニック障害 / 全般',
        methods: [
          { difficulty: 1, title: '時差通勤: 空いている時間帯を選ぶ', tips: '30分早く/遅く出るだけでも違う', evidence: '環境調整法' },
          { difficulty: 2, title: '段階的暴露: 短い区間から練習', tips: '1駅ずつ距離を伸ばしていく', evidence: '暴露療法' },
          { difficulty: 3, title: '通勤方法の変更(車・自転車・在宅)', tips: '会社と相談して代替手段を模索', evidence: '職業リハビリテーション' }
        ]
      },
      {
        id: 22,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '電車が遅延してイライラ',
        targets: '全般',
        methods: [
          { difficulty: 1, title: '「コントロールできない」と受け入れる', tips: '変えられないことに執着しない', evidence: 'ACT' },
          { difficulty: 2, title: '遅延時の対応プラン作成', tips: '代替ルート、連絡方法を事前に準備', evidence: '問題解決療法' },
          { difficulty: 3, title: 'アンガーマネジメント訓練', tips: '怒りのトリガーと対処法を学ぶ', evidence: 'アンガーマネジメント' }
        ]
      },
      {
        id: 23,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '通勤前から憂鬱',
        targets: 'うつ病 / 全般',
        methods: [
          { difficulty: 1, title: '好きな音楽を聴きながら準備', tips: '気分を上げる曲で朝を始める', evidence: '行動活性化療法' },
          { difficulty: 2, title: '「今日の小さな楽しみ」を作る', tips: '通勤中のカフェ、帰りのご褒美など', evidence: '行動活性化療法' },
          { difficulty: 3, title: 'うつ病治療の見直し(薬・休職)', tips: '医師と相談し適切な治療を受ける', evidence: '薬物療法/休養' }
        ]
      },
      {
        id: 24,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '乗り換えで混乱',
        targets: 'ASD / 知的障害',
        methods: [
          { difficulty: 1, title: 'スマホアプリで乗換案内を確認', tips: '画面を見ながら移動する', evidence: '環境調整法' },
          { difficulty: 2, title: '事前練習: 休日にルート確認', tips: '実際に歩いてみて覚える', evidence: '行動療法' },
          { difficulty: 3, title: '通勤訓練(支援者同行)', tips: '最初は一緒に通勤練習', evidence: '職業リハビリテーション' }
        ]
      },
      {
        id: 25,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '外に出られない',
        targets: 'パニック障害 / うつ病',
        methods: [
          { difficulty: 1, title: '玄関まで→郵便受けまで、段階的に', tips: '今日できたところまでで十分', evidence: '行動活性化療法' },
          { difficulty: 2, title: '段階的暴露: 不安階層表を作成', tips: '簡単なものから順番に挑戦', evidence: '暴露療法' },
          { difficulty: 3, title: '広場恐怖症の認知行動療法', tips: '専門家と一緒に恐怖を克服', evidence: '認知行動療法' }
        ]
      },
      {
        id: 26,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '電車を乗り間違えた',
        targets: '全般',
        methods: [
          { difficulty: 1, title: '一度降りて深呼吸→確認', tips: 'パニックにならず落ち着いて対応', evidence: '行動療法' },
          { difficulty: 2, title: '「遅刻しそう」と連絡を入れる', tips: '早めの連絡で心理的負担を軽減', evidence: '問題解決療法' },
          { difficulty: 3, title: 'ルート記憶訓練(視覚支援)', tips: '写真付きマニュアルを作成', evidence: '認知リハビリテーション' }
        ]
      },
      {
        id: 27,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '人混みで息苦しい',
        targets: 'パニック障害 / 不安障害',
        methods: [
          { difficulty: 1, title: '立ち止まって深呼吸→人の少ない場所へ', tips: '「大丈夫、一時的なもの」と自分に言う', evidence: 'リラクセーション法' },
          { difficulty: 2, title: 'グラウンディング技法で現実感を保つ', tips: '5-4-3-2-1法(5感で今に集中)', evidence: 'マインドフルネス' },
          { difficulty: 3, title: 'パニック発作の認知行動療法', tips: '発作への恐怖を軽減する', evidence: '認知行動療法' }
        ]
      },
      {
        id: 28,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '忘れ物をした',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: '深呼吸→本当に必要か考える', tips: '引き返すか代用できるか判断', evidence: '問題解決療法' },
          { difficulty: 2, title: '忘れ物リストをスマホに作る', tips: '出発前チェックリストで確認', evidence: '行動療法' },
          { difficulty: 3, title: 'ADHD向けの生活スキル訓練', tips: '忘れ物を減らす仕組み作り', evidence: 'SST' }
        ]
      },
      {
        id: 29,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '遅刻しそうで焦る',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: '「遅れます」と連絡→安全に移動', tips: '焦って事故を起こさない', evidence: '問題解決療法' },
          { difficulty: 2, title: '余裕を持った出発時間設定', tips: '30分早めに家を出る習慣', evidence: '行動療法' },
          { difficulty: 3, title: '時間管理スキル訓練', tips: 'タイマー活用、逆算思考を学ぶ', evidence: 'SST' }
        ]
      },
      {
        id: 30,
        category: 'commute',
        categoryName: '通勤・移動中',
        title: '知らない道で迷った',
        targets: '全般 / 知的障害',
        methods: [
          { difficulty: 1, title: 'スマホの地図アプリを使う', tips: 'GPS機能で現在地を確認', evidence: '環境調整法' },
          { difficulty: 2, title: '目印を写真で記録しておく', tips: '事前に道順を視覚的に覚える', evidence: '認知リハビリテーション' },
          { difficulty: 3, title: '空間認知訓練', tips: '地図の読み方、方向感覚を訓練', evidence: '認知リハビリテーション' }
        ]
      },
      
      // 人間関係 (31-40)
      {
        id: 31,
        category: 'relations',
        categoryName: '人間関係',
        title: '断れない',
        targets: '全般',
        methods: [
          { difficulty: 1, title: '「考えてから返事します」時間を稼ぐ', tips: '即答しなくてOK', evidence: 'アサーション' },
          { difficulty: 2, title: '断りの台本を作る', tips: '「今は難しいです」のバリエーション', evidence: 'SST' },
          { difficulty: 3, title: 'アサーション訓練', tips: '攻撃的でも受動的でもない自己主張', evidence: 'SST' }
        ]
      },
      {
        id: 32,
        category: 'relations',
        categoryName: '人間関係',
        title: '相手の意図が分からない',
        targets: 'ASD / 全般',
        methods: [
          { difficulty: 1, title: '「〇〇ということですか?」確認する', tips: '推測せず明確化を求める', evidence: 'SST' },
          { difficulty: 2, title: '文脈読解練習: 表情・声のトーンに注目', tips: '非言語コミュニケーションを学ぶ', evidence: 'SST' },
          { difficulty: 3, title: '対人スキル訓練(ロールプレイ)', tips: '様々な場面を想定して練習', evidence: 'SST' }
        ]
      },
      {
        id: 33,
        category: 'relations',
        categoryName: '人間関係',
        title: '会話が続かない',
        targets: 'ASD / 不安障害',
        methods: [
          { difficulty: 1, title: '相槌+オウム返しで間をつなぐ', tips: '「なるほど、〇〇なんですね」', evidence: 'SST' },
          { difficulty: 2, title: '質問リスト作成: 5W1Hで掘り下げる', tips: '「いつ」「どこで」「誰と」など', evidence: 'SST' },
          { difficulty: 3, title: '会話スキル訓練(スクリプト作成)', tips: '場面別の会話パターンを学ぶ', evidence: 'SST' }
        ]
      },
      {
        id: 34,
        category: 'relations',
        categoryName: '人間関係',
        title: '誤解された',
        targets: 'ASD / 全般',
        methods: [
          { difficulty: 1, title: '「誤解があったようです」と説明する', tips: '冷静に事実を伝える', evidence: 'アサーション' },
          { difficulty: 2, title: '誤解を生まない伝え方練習', tips: '具体的・明確な表現を意識', evidence: 'SST' },
          { difficulty: 3, title: 'メタ認知訓練: 相手の視点を理解', tips: '自分の言動が相手にどう見えるか', evidence: 'メタ認知療法' }
        ]
      },
      {
        id: 35,
        category: 'relations',
        categoryName: '人間関係',
        title: '批判されて傷ついた',
        targets: '全般 / うつ病',
        methods: [
          { difficulty: 1, title: '事実と感情を分けて記録する', tips: '「〇〇と言われた(事実)」「傷ついた(感情)」', evidence: '認知行動療法' },
          { difficulty: 2, title: '建設的批判と攻撃を区別する', tips: '成長のヒントとして受け取れるか考える', evidence: '認知行動療法' },
          { difficulty: 3, title: '自己価値の安定化(スキーマ療法)', tips: '他者評価に左右されない自己肯定感', evidence: 'スキーマ療法' }
        ]
      },
      {
        id: 36,
        category: 'relations',
        categoryName: '人間関係',
        title: '怒られているように感じる',
        targets: '不安障害 / ASD',
        methods: [
          { difficulty: 1, title: '「怒っていますか?」と確認する', tips: '推測を事実確認に変える', evidence: '現実検討' },
          { difficulty: 2, title: '認知の歪み修正: 心の読みすぎ', tips: '根拠のない推測に気づく', evidence: '認知行動療法' },
          { difficulty: 3, title: '表情認知訓練', tips: '表情と感情の関係を学ぶ', evidence: 'SST' }
        ]
      },
      {
        id: 37,
        category: 'relations',
        categoryName: '人間関係',
        title: '注意されて泣きそう',
        targets: '全般',
        methods: [
          { difficulty: 1, title: '「少し席を外します」その場を離れる', tips: 'トイレで深呼吸して落ち着く', evidence: '行動療法' },
          { difficulty: 2, title: '感情調節: TIPPスキル(冷水で顔を洗う)', tips: '強い感情を物理的に鎮める', evidence: 'DBT' },
          { difficulty: 3, title: 'DBT: 感情耐性スキル訓練', tips: 'つらい感情との付き合い方を学ぶ', evidence: 'DBT' }
        ]
      },
      {
        id: 38,
        category: 'relations',
        categoryName: '人間関係',
        title: '視線が怖い',
        targets: '不安障害 / 統合失調症',
        methods: [
          { difficulty: 1, title: '視線を外す: 首元や鼻あたりを見る', tips: '目を合わせなくても失礼ではない', evidence: '環境調整法' },
          { difficulty: 2, title: '認知再構成:「見られている=攻撃」の修正', tips: '視線の意味を中立的に解釈', evidence: '認知行動療法' },
          { difficulty: 3, title: '被注察感の治療(医療的アプローチ)', tips: '症状が強い場合は医師に相談', evidence: '薬物療法' }
        ]
      },
      {
        id: 39,
        category: 'relations',
        categoryName: '人間関係',
        title: '輪に入れない',
        targets: 'ASD / 不安障害',
        methods: [
          { difficulty: 1, title: '一人でいる時間を確保する', tips: '無理に溶け込まなくてOK', evidence: 'セルフケア' },
          { difficulty: 2, title: '共通の話題を見つける練習', tips: '天気、ニュース、趣味などから', evidence: 'SST' },
          { difficulty: 3, title: 'グループ参加スキル訓練', tips: 'タイミング、会話の入り方を練習', evidence: 'SST' }
        ]
      },
      {
        id: 40,
        category: 'relations',
        categoryName: '人間関係',
        title: '嫌なことを頼まれた',
        targets: '全般',
        methods: [
          { difficulty: 1, title: 'DESC法:事実→感情→提案→結果', tips: '「これは難しいです。代わりに〇〇できます」', evidence: 'アサーション' },
          { difficulty: 2, title: '断りの練習(ロールプレイ)', tips: '様々なパターンで断る練習', evidence: 'SST' },
          { difficulty: 3, title: '境界線設定のカウンセリング', tips: '健全な境界線を学ぶ', evidence: '心理療法' }
        ]
      },
      
      // 家庭・日常 (41-45)
      {
        id: 41,
        category: 'home',
        categoryName: '家庭・日常',
        title: '家事が溜まって憂鬱',
        targets: 'うつ病 / 全般',
        methods: [
          { difficulty: 1, title: '1つだけやる: 皿洗いor洗濯だけ', tips: '完璧を目指さず小さく始める', evidence: '行動活性化療法' },
          { difficulty: 2, title: 'タスクの細分化: 5分でできる単位に', tips: '大きなタスクを小さく分解', evidence: '行動療法' },
          { difficulty: 3, title: '家事支援サービスの利用検討', tips: '無理せず外部サービスを頼る', evidence: '環境調整法' }
        ]
      },
      {
        id: 42,
        category: 'home',
        categoryName: '家庭・日常',
        title: '眠れない',
        targets: '全般 / 不安障害',
        methods: [
          { difficulty: 1, title: 'スリープハイジーン: 寝室を暗く涼しく', tips: '就寝1時間前にスマホ OFF', evidence: '睡眠衛生' },
          { difficulty: 2, title: '刺激統制法: ベッドは寝るためだけに', tips: '眠れない時はベッドから出る', evidence: '認知行動療法(不眠)' },
          { difficulty: 3, title: '不眠症の認知行動療法(CBT-I)', tips: '専門家による睡眠プログラム', evidence: 'CBT-I' }
        ]
      },
      {
        id: 43,
        category: 'home',
        categoryName: '家庭・日常',
        title: '予定がない休日が不安',
        targets: 'ASD / 不安障害',
        methods: [
          { difficulty: 1, title: '簡単な予定を入れる: 散歩、読書', tips: '「何もしない」も立派な予定', evidence: '行動活性化療法' },
          { difficulty: 2, title: 'ルーティン作り: 午前中の予定を固定', tips: '毎週同じ時間に同じことをする', evidence: '行動療法' },
          { difficulty: 3, title: 'デイケア・地域活動への参加', tips: '定期的な予定と社会的つながり', evidence: '社会リハビリテーション' }
        ]
      },
      {
        id: 44,
        category: 'home',
        categoryName: '家庭・日常',
        title: '夜更かししてしまう',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: '就寝時刻アラームを設定', tips: '22時にアラーム→準備開始', evidence: '行動療法' },
          { difficulty: 2, title: '夜の習慣ルーティンを作る', tips: '歯磨き→着替え→読書→就寝', evidence: '行動療法' },
          { difficulty: 3, title: '概日リズム睡眠障害の治療', tips: '光療法、メラトニン調整', evidence: '医学的治療' }
        ]
      },
      {
        id: 45,
        category: 'home',
        categoryName: '家庭・日常',
        title: '月曜日が憂鬱',
        targets: 'うつ病 / 全般',
        methods: [
          { difficulty: 1, title: '日曜夜の小さな楽しみを作る', tips: '好きな番組、美味しいもの', evidence: '行動活性化療法' },
          { difficulty: 2, title: '月曜の小さな目標設定', tips: '「午前中乗り切る」など小さく', evidence: '認知行動療法' },
          { difficulty: 3, title: '職場環境の見直し(配置転換・時短)', tips: 'なぜ憂鬱なのか根本原因を探る', evidence: '職業リハビリテーション' }
        ]
      },
      
      // 就職活動 (46-50)
      {
        id: 46,
        category: 'job',
        categoryName: '就職活動',
        title: '面接が怖い',
        targets: '不安障害 / 全般',
        methods: [
          { difficulty: 1, title: '想定問答を作る: よくある質問を準備', tips: '「緊張しています」と正直に伝えてもOK', evidence: '準備技法' },
          { difficulty: 2, title: '模擬面接を繰り返す', tips: '支援者と一緒に練習', evidence: 'SST' },
          { difficulty: 3, title: '社交不安障害の認知行動療法', tips: '段階的暴露とスキル訓練', evidence: '認知行動療法' }
        ]
      },
      {
        id: 47,
        category: 'job',
        categoryName: '就職活動',
        title: '不採用が続いてつらい',
        targets: 'うつ病 / 全般',
        methods: [
          { difficulty: 1, title: '「マッチングの問題」と考える', tips: '不採用=自分の否定ではない', evidence: '認知再構成' },
          { difficulty: 2, title: '支援者と振り返り: 改善点を見つける', tips: '建設的なフィードバックを得る', evidence: '問題解決療法' },
          { difficulty: 3, title: '就労支援プログラムの活用', tips: '一人で抱え込まず専門家と相談', evidence: '職業リハビリテーション' }
        ]
      },
      {
        id: 48,
        category: 'job',
        categoryName: '就職活動',
        title: '障害を伝えるか迷う',
        targets: '全般',
        methods: [
          { difficulty: 1, title: 'メリット・デメリットを書き出す', tips: 'オープン・クローズそれぞれを整理', evidence: '意思決定支援' },
          { difficulty: 2, title: '支援者と一緒に開示内容を整理', tips: '伝える内容・配慮事項を明確化', evidence: '就労支援' },
          { difficulty: 3, title: '職場見学・実習で判断', tips: '実際の環境を見て決める', evidence: '職業リハビリテーション' }
        ]
      },
      {
        id: 49,
        category: 'job',
        categoryName: '就職活動',
        title: '履歴書が書けない',
        targets: 'ADHD / 全般',
        methods: [
          { difficulty: 1, title: '長所を3つ書き出すところから', tips: '完璧を目指さない。支援者に相談OK', evidence: '行動活性化療法' },
          { difficulty: 2, title: '支援者と一緒に書く', tips: 'エピソードを聞き出してもらう', evidence: '就労支援' },
          { difficulty: 3, title: '履歴書作成ワークショップ参加', tips: 'グループで学び合う', evidence: 'SST/就労支援' }
        ]
      },
      {
        id: 50,
        category: 'job',
        categoryName: '就職活動',
        title: '就活自体が不安',
        targets: '不安障害 / 全般',
        methods: [
          { difficulty: 1, title: '小さな目標: まず求人を1つ見る', tips: '焦らない。自分のペースで', evidence: '行動活性化療法' },
          { difficulty: 2, title: '就活スケジュールを細分化', tips: '1週間ごとの小目標を設定', evidence: '問題解決療法' },
          { difficulty: 3, title: '就労移行支援の利用', tips: '段階的に就活準備を進める', evidence: '職業リハビリテーション' }
        ]
      }
    ];
    
    let currentCategory = 'all';
    let searchQuery = '';
    
    // 初期化
    document.addEventListener('DOMContentLoaded', () => {
      renderCards();
      setupFilters();
      setupSearch();
    });
    
    // カードの描画
    function renderCards() {
      const grid = document.getElementById('cardsGrid');
      const noResults = document.getElementById('noResults');
      
      let filteredCards = cardsData;
      
      // カテゴリフィルター
      if (currentCategory !== 'all') {
        filteredCards = filteredCards.filter(card => card.category === currentCategory);
      }
      
      // 検索フィルター
      if (searchQuery) {
        filteredCards = filteredCards.filter(card => 
          card.title.includes(searchQuery) || 
          card.categoryName.includes(searchQuery) ||
          card.targets.includes(searchQuery)
        );
      }
      
      if (filteredCards.length === 0) {
        grid.style.display = 'none';
        noResults.style.display = 'block';
        return;
      }
      
      grid.style.display = 'grid';
      noResults.style.display = 'none';
      
      grid.innerHTML = filteredCards.map(card => `
        <div class="card-item" onclick="openModal(${card.id})">
          <div class="card-header cat-${card.category}">
            <div class="card-category">${card.categoryName}</div>
            <div class="card-title">${card.title}</div>
            <div class="card-targets">${card.targets}</div>
          </div>
        </div>
      `).join('');
    }
    
    // フィルターセットアップ
    function setupFilters() {
      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          filterButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentCategory = btn.dataset.category;
          renderCards();
        });
      });
    }
    
    // 検索セットアップ
    function setupSearch() {
      const searchBox = document.getElementById('searchBox');
      searchBox.addEventListener('input', (e) => {
        searchQuery = e.target.value;
        renderCards();
      });
    }
    
    // モーダルを開く
    function openModal(cardId) {
      const card = cardsData.find(c => c.id === cardId);
      const modal = document.getElementById('modal');
      const modalHeader = document.getElementById('modalHeader');
      const modalBody = document.getElementById('modalBody');
      
      modalHeader.innerHTML = `
        <div class="modal-category">${card.categoryName}</div>
        <div class="modal-title">${card.title}</div>
        <div class="modal-targets">${card.targets}</div>
      `;
      
      const difficultyLabels = [
        '<span class="star">★</span>☆☆ 今すぐ試せる',
        '<span class="star">★★</span>☆ 少し練習が必要',
        '<span class="star">★★★</span> サポートが必要'
      ];
      
      modalBody.innerHTML = card.methods.map((method, index) => `
        <div class="method-section difficulty-${method.difficulty}">
          <div class="method-header">${difficultyLabels[index]}</div>
          <div class="method-title">${method.title}</div>
          <div class="method-tips">ポイント：${method.tips}</div>
          <div class="method-evidence">根拠：<span class="therapy-link" data-therapy="${method.evidence}">${method.evidence}</span></div>
        </div>
      `).join('');
      
      // 療法リンクにイベントリスナーを追加
      const therapyLinks = modalBody.querySelectorAll('.therapy-link');
      therapyLinks.forEach(link => {
        link.addEventListener('mouseenter', showTooltip);
        link.addEventListener('mouseleave', hideTooltip);
        link.addEventListener('mousemove', moveTooltip);
      });
      
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    // ツールチップ表示
    let tooltip = null;
    
    function showTooltip(e) {
      const therapy = e.target.dataset.therapy;
      const description = therapyInfo[therapy] || 'この療法の詳細情報は準備中です。';
      
      tooltip = document.createElement('div');
      tooltip.className = 'tooltip';
      tooltip.textContent = description;
      document.body.appendChild(tooltip);
      
      moveTooltip(e);
    }
    
    function moveTooltip(e) {
      if (!tooltip) return;
      
      const x = e.clientX;
      const y = e.clientY;
      
      tooltip.style.left = x + 'px';
      tooltip.style.top = (y - tooltip.offsetHeight - 15) + 'px';
    }
    
    function hideTooltip() {
      if (tooltip) {
        tooltip.remove();
        tooltip = null;
      }
    }
    
    // モーダルを閉じる
    function closeModal() {
      const modal = document.getElementById('modal');
      modal.classList.remove('active');
      document.body.style.overflow = 'auto';
      hideTooltip(); // ツールチップも削除
    }
    
    // モーダル外クリックで閉じる
    document.getElementById('modal').addEventListener('click', (e) => {
      if (e.target.id === 'modal') {
        closeModal();
      }
    });
    
    // ESCキーで閉じる
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeModal();
      }
    });
  </script>
</body>
</html>
